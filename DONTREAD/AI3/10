### Testing Strategy (Unit/Integration/E2E/Contract Matrix)

- Goal(s): Ensure correctness with layered tests; enforce in CI.

### Assumptions
- Pyramid emphasis on unit/integration; selective e2e.

### Alternatives
- E2E-heavy (slow, brittle).

### Risks & Mitigations
- Flaky tests (M×M): Retry + quarantine policy.
- Contract drift (M×H): Pact + schema checks in CI.

### Dependencies
- Test runners, contract tooling, ephemeral envs.

### Matrix

| Layer | Scope | Tools | Gate |
|---|---|---|---|
| Unit | Functions/components | Vitest/Jest | Required on PR |
| Integration | Modules/db | Testcontainers | Required on PR |
| Contract | Provider/consumer | Pact, schema | Required on RC |
| E2E | Happy paths | Playwright/Cypress | Required on RC |
| Non-func | Perf/a11y | k6/Lighthouse | Staging gate |

### Trigger → Rule → File(s)/Output mapping

| Trigger | Rules | Files/Outputs | Gates |
|---|---|---|---|
| testing | `F7-qa`, `3-code-quality-checklist` | This strategy | Coverage ≥ threshold |
| release | `F9-release` | Release checklist | RC gates pass |

### Success Metrics
- PR pass rate > 90% with stable duration; flaky rate < 2%.

### Next Steps
- Define thresholds; add contract tests to CI matrix.
